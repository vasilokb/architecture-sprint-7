# Шаг 1. Анализ схемы и описания системы PropDevelopment

## 1. Идентификация бизнес-систем
На основе описания и диаграммы C4 выделены основные системы, которые поддерживают бизнес-процессы PropDevelopment. Эти системы разделены по доменам.

### Группа сервисов для продаж (клиентские сервисы)
- **Витрина продаж (sales_showcase)**
    - **Описание:** JavaScript, React — интерфейс для подбора и бронирования недвижимости клиентами.
    - **Роль:** Первая точка взаимодействия с клиентами, нет собственной базы данных, зависит от других систем.
- **client-tour-app**
    - **Описание:** Kotlin, SpringBoot — приложение для онлайн-туров, база данных PostgreSQL (client-tour-db).
    - **Роль:** Хранит данные о показах объектов, интегрируется с витриной и CRM.
- **client-mart-app**
    - **Описание:** Kotlin, SpringBoot — приложение для онлайн-сделок, база данных PostgreSQL (client-mart-db).
    - **Роль:** Обрабатывает сделки, интегрируется с госорганами (СМЭВ, SOAP).
- **client-crm-app**
    - **Описание:** SpringBoot, ElasticSearch, Dynamics CRM — управление клиентскими данными, база данных MSSQL (crm-db).
    - **Роль:** Хранит персональные данные клиентов, используется менеджерами.
- **client-mart-estate-app**
    - **Описание:** Kotlin, SpringBoot — управление данными о недвижимости, база данных PostgreSQL (client-mart-estate-db).
    - **Роль:** Публикует каталог объектов, источник данных для витрины и сделок.
- **auth-service-1**
    - **Описание:** Keycloak — аутентификация покупателей, база данных PostgreSQL (auth-db-1).
    - **Роль:** Обеспечивает доступ клиентов к системам, интегрируется с Active Directory (LDAP).

### Группа сервисов ЖКУ (услуги для собственников)
- **Витрина сервисов для собственников (owner_services_showcase)**
    - **Описание:** Мобильное приложение (iOS, Android) — интерфейс для собственников.
    - **Роль:** Доступ к услугам ЖКХ, "Умному дому" и оплате, нет собственной БД.
- **tenant-core-app**
    - **Описание:** Kotlin, SpringBoot — предоставление услуг собственникам, база данных PostgreSQL (tenant-core-db).
    - **Роль:** Хранит данные о ЖКХ и "Умном доме", интегрируется с партнёрами.
- **CRM**
    - **Описание:** Kotlin, SpringBoot — управление данными собственников, база данных PostgreSQL (crm-tenant-db).
    - **Роль:** Хранит персональные данные собственников, используется менеджерами.

### Финансы
- **accountant-service-1**
    - **Описание:** Keycloak — система бухгалтерского учёта, база данных PostgreSQL (accountant-service-db).
    - **Роль:** Учёт платежей и финансов, доступ для бухгалтеров, интеграция с Active Directory.

### Дата
- **Хранилище данных (DWH)**
    - **Описание:** Greenplum — единое хранилище данных, физическое хранилище S3 (dwh-storage).
    - **Роль:** Собирает данные из всех систем (CDC), используется аналитиками для BI.

### Инфраструктурные компоненты
- **Active Directory**
    - **Описание:** Служба каталогов для аутентификации сотрудников и аналитиков.
    - **Роль:** Централизованная аутентификация (LDAP).
- **firewall_client и firewall_utility**
    - **Описание:** Межсетевые экраны для фильтрации трафика клиентов и собственников.
    - **Роль:** Защита внешнего доступа.

## 2. Характер работы систем с точки зрения безопасности
### Группа сервисов для продаж
- **Витрина продаж (sales_showcase)**
    - **Данные:** Публичные (характеристики объектов).
    - **Безопасность:** Доступ через firewall_client (REST), зависит от client-mart-app, client-tour-app и client-crm-app. Уязвима к искажению данных (человеческий фактор, атаки).
    - **Риск:** Отсутствие собственной БД делает её зависимой от целостности других систем.
- **client-tour-app**
    - **Данные:** Внутренние (данные о показах), конфиденциальные (привязка к клиентам).
    - **Безопасность:** Хранит данные в client-tour-db, интегрируется с client-crm-app (REST). Риск искажения или утечки при передаче данных.
- **client-mart-app**
    - **Данные:** Конфиденциальные (детали сделок), секретные (интеграция с госорганами).
    - **Безопасность:** Интеграция с СМЭВ (SOAP) требует ключей шифрования, уязвима к утечке через слабые API или ошибки конфигурации.
- **client-crm-app**
    - **Данные:** Конфиденциальные (персональные данные клиентов).
    - **Безопасность:** MSSQL (crm-db), доступ менеджеров через Active Directory (LDAP). Жалобы на чужие данные указывают на проблемы интеграции (REST).
- **client-mart-estate-app**
    - **Данные:** Внутренние (статусы объектов).
    - **Безопасность:** Публикует данные через Kafka, уязвима к некачественным данным из-за несогласованности с витриной.
- **auth-service-1**
    - **Данные:** Секретные (учетные данные, токены).
    - **Безопасность:** Keycloak, PostgreSQL (auth-db-1), интеграция с Active Directory. Критична для всех клиентских систем, уязвима к утечке при слабом шифровании.

### Группа сервисов ЖКУ
- **Витрина сервисов (owner_services_showcase)**
    - **Данные:** Публичные (информация о доме), конфиденциальные (платежи, настройки "Умного дома").
    - **Безопасность:** Доступ через firewall_utility (REST), интегрируется с tenant-core-app, CRM, payment_system и utility_provider. Уязвима к утечке через API партнёров.
- **tenant-core-app**
    - **Данные:** Конфиденциальные (ЖКХ, "Умный дом"), секретные (мастер-коды).
    - **Безопасность:** PostgreSQL (tenant-core-db), REST с партнёрами. Риск утечки из-за слабых политик API.
- **CRM**
    - **Данные:** Конфиденциальные (данные собственников).
    - **Безопасность:** PostgreSQL (crm-tenant-db), доступ через Active Directory. Риск искажения из-за несогласованности с витриной.

### Финансы
- **accountant-service-1**
    - **Данные:** Конфиденциальные (финансовые данные).
    - **Безопасность:** PostgreSQL (accountant-service-db), доступ бухгалтеров через Active Directory. Риск потери данных при сбоях.

### Дата
- **Хранилище данных (DWH)**
    - **Данные:** Все категории (сырые данные через CDC).
    - **Безопасность:** Greenplum, S3, доступ аналитиков через LDAP. Риск утечки неагрегированных данных.

### Инфраструктурные компоненты
- **Active Directory**
    - **Данные:** Секретные (учетные данные сотрудников).
    - **Безопасность:** LDAP, критична для всех систем, уязвима к компрометации.
- **Firewalls**
    - **Данные:** Конфигурация (секретные).
    - **Безопасность:** Фильтруют трафик, уязвимы к неправильной настройке.

## 3. Выводы по безопасности
- **Ключевые уязвимости:**
    - API-интеграции (client-mart-app, owner_services_showcase) с партнёрами и госорганами — риск утечки и избыточной передачи данных.
    - Несогласованность данных между системами (client-crm-app, tenant-core-app) — причина жалоб на чужие данные.
    - auth-service-1 и Active Directory — точки риска для секретных данных.
- **Характер работы:**
    - Системы для продаж: Высокая зависимость от интеграций и аутентификации.
    - Системы ЖКУ: Уязвимы к внешним партнёрам и управлению "Умным домом".
    - Финансы и DWH: Требуют защиты данных и стабильности.

---

# Шаг 2. Предлагаемые разделы проверочного листа

На основе проблем, приоритетов и анализа предлагается включить следующие разделы для проверочного листа безопасности бизнес-систем. Каждый раздел подробно обоснован.

1. **Управление доступом и аутентификация**
    - **Почему включён:**
        - **Проблема:** auth-service-1 (Keycloak) и Active Directory — критические точки для всех систем, уязвимые к утечке секретных данных (учётные данные, токены). Один специалист по ИБ и разрывы в коммуникации повышают риск неправильной конфигурации.
        - **Приоритет:** Предотвращение инцидентов (утечка у конкурента) требует строгого контроля доступа.
        - **Связь с системами:** auth-service-1 используется витриной продаж, owner_services_showcase и другими системами; Active Directory — для менеджеров, бухгалтеров и аналитиков.
    - **Что проверять:** Шифрование учётных данных, настройки ролей, актуальность токенов.
    - **Ожидаемый эффект:** Снижение риска компрометации систем через слабую аутентификацию.

2. **Интеграции и API**
    - **Почему включён:**
        - **Проблема:** API партнёров (utility_provider, payment_system, СМЭВ) передают избыточные данные, включая персональные, без единых политик безопасности. Жалобы на чужие данные указывают на уязвимости в owner_services_showcase и client-mart-app.
        - **Приоритет:** Соответствие законодательству (ФЗ-152) и удовлетворённость клиентов требуют защиты данных в интеграциях.
        - **Связь с системами:** client-mart-app (SOAP с госорганами), owner_services_showcase (REST с партнёрами), tenant-core-app (данные "Умного дома").
    - **Что проверять:** Ограничения доступа в API-контрактах, шифрование передаваемых данных, логирование запросов.
    - **Ожидаемый эффект:** Устранение утечек и ошибок в кабинетах, повышение доверия клиентов.

3. **Целостность и согласованность данных**
    - **Почему включён:**
        - **Проблема:** Несогласованность данных между системами (client-crm-app, tenant-core-app, sales_showcase) из-за множества точек регистрации и слабого контроля потоков. Это приводит к жалобам на чужие данные.
        - **Приоритет:** Удовлетворённость клиентов и развитие BI/ML/AI зависят от качественных данных.
        - **Связь с системами:** client-crm-app, CRM, client-mart-estate-app, DWH (CDC-передача).
    - **Что проверять:** Синхронизацию данных, дедупликацию записей, целостность при передаче (REST, Kafka).
    - **Ожидаемый эффект:** Устранение ошибок в личных кабинетах, подготовка данных для аналитики.

4. **Защита баз данных**
    - **Почему включён:**
        - **Проблема:** Множество баз (PostgreSQL, MSSQL) хранят конфиденциальные и секретные данные (crm-db, tenant-core-db, client-mart-db). Потеря или утечка данных критичны.
        - **Приоритет:** Предотвращение инцидентов и соответствие законодательству требуют надёжной защиты.
        - **Связь с системами:** client-tour-db, client-mart-db, crm-db, tenant-core-db, accountant-service-db, auth-db-1.
    - **Что проверять:** Шифрование на уровне БД, резервное копирование, контроль доступа.
    - **Ожидаемый эффект:** Снижение риска потери данных и обеспечение их восстановления.

5. **Безопасность "Умного дома"**
    - **Почему включён:**
        - **Проблема:** tenant-core-app управляет "Умным домом" (мастер-коды, автоматика), что делает его мишенью для атак. Утечка кодов через API партнёров катастрофична.
        - **Приоритет:** Удовлетворённость собственников и предотвращение инцидентов (физическая безопасность жильцов).
        - **Связь с системами:** tenant-core-app, owner_services_showcase.
    - **Что проверять:** Шифрование кодов, ограничение доступа партнёров, мониторинг изменений.
    - **Ожидаемый эффект:** Защита жильцов и репутации компании.

6. **Мониторинг и логирование**
    - **Почему включён:**
        - **Проблема:** Отсутствие системного контроля потоков данных и слабая передача информации специалисту по ИБ затрудняют выявление инцидентов.
        - **Приоритет:** Предотвращение инцидентов и соответствие законодательству требуют прозрачности.
        - **Связь с системами:** Все системы (firewalls, API, DWH).
    - **Что проверять:** Наличие логов, их защита, мониторинг аномалий.
    - **Ожидаемый эффект:** Быстрое реагирование на угрозы, доказательства для аудита.

---

### Почему выбраны именно эти разделы
1. **Управление доступом и аутентификация** — основа безопасности всех систем, критична из-за одного специалиста по ИБ и уязвимостей auth-service-1.
2. **Интеграции и API** — главная проблема компании (утечки через партнёров), напрямую связана с жалобами клиентов и законом.
3. **Целостность и согласованность данных** — решает проблему несогласованности, ключ к BI/ML/AI и устранению ошибок в кабинетах.
4. **Защита баз данных** — обеспечивает сохранность данных, минимизирует риски потери и утечки.
5. **Безопасность "Умного дома"** — уникальная для PropDevelopment угроза, связана с физической безопасностью и репутацией.
6. **Мониторинг и логирование** — закрывает пробел в прозрачности процессов, усиливает контроль.

## Что не включено
- **Обновление ПО:** Нет данных о проблемах с версиями, приоритет ниже.
- **Физическая безопасность ЦОД:** Вне фокуса задания, нет явных угроз.

---

# Шаг 3. Проверочный лист безопасности для бизнес-систем PropDevelopment

| №   | Вопрос                                                                                                                                   | Да/Нет | Комментарий                                                                                           |
| --- | ---------------------------------------------------------------------------------------------------------------------------------------- | -------| ------------------------------------------------------------------------------------------------------|
| **I. Управление доступом и аутентификация**                                                                                                |        |                                                                                                       |
| 1   | Используется ли многофакторная аутентификация (MFA) для доступа к критическим системам и сервисам?                                       | Нет    | Нет данных о применении MFA в auth-service-1 или Active Directory. Возможный риск для секретных данных.|
| 2   | Настроены ли требования к сложности паролей и их регулярное обновление?                                                                  | Нет данных | Описание не упоминает политики паролей в Keycloak или Active Directory. Требует проверки.            |
| 3   | Проводится ли аудит и пересмотр учётных записей с повышенными привилегиями на регулярной основе?                                         | Нет    | Один специалист по ИБ и разрывы в коммуникации указывают на отсутствие регулярного аудита.            |
| 4   | Реализован ли принцип минимальных привилегий при назначении ролей и прав доступа?                                                        | Нет данных | Нет информации о настройках ролей в auth-service-1 или Active Directory. Требует уточнения.          |
| 5   | Автоматически ли удаляются или деактивируются учётные записи после увольнения или изменения должности сотрудников?                      | Нет данных | Отсутствие данных о процессах управления учётками в Active Directory. Возможный риск устаревших доступов.|
| 6   | Ведётся ли журналирование всех операций доступа к системам и данным? Кто имеет доступ к журналам?                                        | Нет данных | Нет упоминаний о логировании доступа в auth-service-1 или других системах. Требует проверки.         |
| 7   | Используются ли механизмы контроля доступа на основе атрибутов для повышения гибкости управления доступом?                              | Нет данных | Нет информации о таких механизмах в Keycloak или Active Directory. Требует анализа.                  |
| 8   | Используются ли системы аутентификации пользователей для доступа к системам?                                                             | Да     | auth-service-1 (Keycloak) используется для клиентов, Active Directory — для сотрудников.             |
| 9   | Созданы ли замкнутые контуры для подсистем, работающих с чувствительными данными?                                                        | Нет    | Отсутствие сегментации для tenant-core-app ("Умный дом") или client-mart-app (сделки).               |
| 10  | Ограничен ли доступ к системам из внешних источников?                                                                                    | Да     | Firewall_client и firewall_utility фильтруют трафик для клиентов и собственников.                    |
| 11  | Ведётся ли единый реестр учётных записей?                                                                                               | Да     | Active Directory используется как служба каталогов, вероятно, содержит реестр сотрудников.          |
| 12  | Используются ли средства управления учётными записями на базе единого реестра?                                                          | Да     | Active Directory управляет доступом менеджеров, бухгалтеров и аналитиков через LDAP.                |
| 13  | Применяются ли средства для отзыва прав доступа?                                                                                        | Нет данных | Нет информации о процессах отзыва в auth-service-1 или Active Directory. Требует проверки.           |
| 14  | Используются ли средства централизованного контроля доступа?                                                                            | Да     | auth-service-1 и Active Directory обеспечивают централизованную аутентификацию.                     |
| **II. Интеграции и API**                                                                                                                   |        |                                                                                                       |
| 1   | Ограничен ли доступ через API только необходимыми данными и функциями в соответствии с контрактами?                                      | Нет    | Проблемы с API партнёров: избыточная передача данных (client-mart-app, owner_services_showcase).     |
| 2   | Используется ли шифрование данных при передаче через API (например, TLS)?                                                               | Нет данных | Нет упоминаний о шифровании в REST/SOAP для client-mart-app или owner_services_showcase. Требует проверки.|
| 3   | Ведётся ли логирование всех запросов и ответов API для анализа инцидентов?                                                              | Нет данных | Отсутствие данных о логировании API в описании. Требует уточнения.                                   |
| 4   | Проверяются ли внешние системы (партнёры) на соответствие стандартам безопасности перед интеграцией?                                    | Нет    | Нет единых политик безопасности для API партнёров (utility_provider, payment_system).               |
| 5   | Реализованы ли ограничения на доступ партнёров к данным других управляющих компаний?                                                    | Нет    | Партнёры видят чужие данные через API (owner_services_showcase), что указывает на проблему.          |
| 6   | Используются ли токены или API-ключи с ограниченным сроком действия для интеграций?                                                     | Нет данных | Нет информации о токенах в API для client-mart-app или tenant-core-app. Требует проверки.            |
| **III. Целостность и согласованность данных**                                                                                              |        |                                                                                                       |
| 1   | Реализована ли синхронизация данных между системами для предотвращения дубликатов и несогласованности?                                   | Нет    | Множество точек регистрации (sales_showcase, client-crm-app) без координации.                       |
| 2   | Проверяется ли целостность данных при передаче между системами (REST, Kafka, CDC)?                                                      | Нет данных | Нет упоминаний о контроле целостности в интеграциях. Требует проверки.                              |
| 3   | Используются ли процессы дедупликации клиентских данных в CRM-системах?                                                                 | Нет    | Жалобы на чужие данные указывают на отсутствие дедупликации в client-crm-app и CRM.                 |
| 4   | Ведётся ли мониторинг несогласованности данных в реальном времени?                                                                      | Нет    | Отсутствие системного контроля потоков данных (описание проблем).                                   |
| 5   | Проверяется ли корректность отображения данных в личных кабинетах клиентов и собственников?                                             | Нет    | Жалобы на ошибки в owner_services_showcase подтверждают проблему.                                   |
| **IV. Защита баз данных**                                                                                                                  |        |                                                                                                       |
| 1   | Используется ли шифрование на уровне базы данных для защиты конфиденциальных данных?                                                    | Нет данных | Нет информации о шифровании в PostgreSQL/MSSQL (crm-db, tenant-core-db). Требует проверки.          |
| 2   | Реализованы ли механизмы управления ключами шифрования для баз данных?                                                                  | Нет данных | Нет данных о ключах для БД. Требует анализа.                                                        |
| 3   | Проводится ли регулярное резервное копирование данных? Хранятся ли копии в защищённых хранилищах?                                       | Да     | Описание подтверждает резервное копирование для всех БД с достаточной глубиной.                     |
| 4   | Выполняется ли регулярное тестирование процесса восстановления данных из резервных копий?                                               | Нет данных | Нет упоминаний о тестировании восстановления. Требует проверки.                                     |
| 5   | Ограничен ли доступ к резервным копиям данных, и зашифрованы ли они?                                                                    | Нет данных | Нет информации о защите копий. Требует уточнения.                                                   |
| 6   | Ведётся ли учёт персональных данных в базах в соответствии с законодательством (ФЗ-152)?                                                | Нет данных | Нет данных о соответствии ФЗ-152 в crm-db и tenant-core-db. Требует проверки.                       |
| 7   | Используются ли системы контроля целостности данных в базах?                                                                            | Нет данных | Нет упоминаний о проверках целостности в БД. Требует анализа.                                       |
| **V. Безопасность "Умного дома"**                                                                                                          |        |                                                                                                       |
| 1   | Используется ли шифрование для хранения и передачи мастер-кодов "Умного дома"?                                                          | Нет данных | Нет информации о шифровании в tenant-core-app. Требует проверки.                                    |
| 2   | Ограничен ли доступ партнёров к данным "Умного дома" через API?                                                                         | Нет    | API партнёров (utility_provider) передаёт избыточные данные, включая настройки "Умного дома".        |
| 3   | Ведётся ли мониторинг изменений настроек "Умного дома" в реальном времени?                                                              | Нет данных | Нет данных о мониторинге в tenant-core-app. Требует проверки.                                       |
| 4   | Реализованы ли механизмы отзыва доступа к "Умному дому" при компрометации?                                                              | Нет данных | Нет информации о таких механизмах. Требует анализа.                                                 |
| **VI. Мониторинг и логирование**                                                                                                           |        |                                                                                                       |
| 1   | Используется ли система мониторинга безопасности (SIEM) для анализа событий в реальном времени?                                          | Нет данных | Нет упоминаний о SIEM в описании. Требует проверки.                                                 |
| 2   | Настроены ли автоматические оповещения о подозрительной активности (например, несанкционированный доступ)?                              | Нет данных | Нет данных об оповещениях. Требует уточнения.                                                       |
| 3   | Ведётся ли логирование всех операций в системах и доступ к данным?                                                                      | Нет данных | Нет информации о логировании в системах. Требует анализа.                                           |
| 4   | Ограничен ли доступ к логам, и защищены ли они от изменений?                                                                            | Нет данных | Нет данных о защите логов. Требует проверки.                                                        |
| 5   | Проводится ли регулярный анализ логов для выявления инцидентов?                                                                         | Нет    | Один специалист по ИБ и слабая коммуникация указывают на отсутствие анализа.                        |

---
